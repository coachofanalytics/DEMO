{% extends "main/base_templates/new_base.html" %}
{% block content %}
<div class="container mt-5 mb-5">
    <div class="jumbotron text-center" style="background-color: #243865;">
        <h1 class="display-4" style="color: aliceblue;" id="reportTitle">{{ company_name }} Balance Sheet</h1>
        <p class="lead"><span id="current-date-time" class="font-weight-bold text-warning"></span></p>
    </div>    
    <div class="row">
        <!-- Buttons Section -->
        <div class="col-md-12 mb-4 text-center">
            <a href="javascript:void(0);" style="margin-right: 10px;" class="btn btn-secondary" data-toggle="tooltip" data-placement="top" title="View Balance Sheet" onclick="showBalanceSheet()">Balance Sheet</a>
            <a href="javascript:void(0);" style="margin-right: 10px;" class="btn btn-secondary" data-toggle="tooltip" data-placement="top" title="View Balance Sheet" onclick="showFinancialStatement()">Financial Statement</a>
            <a href="javascript:void(0);" style="margin-right: 10px;" class="btn btn-secondary" data-toggle="tooltip" data-placement="top" title="View Balance Sheet" onclick="showCashFlowStatement()">Cash Flow Statement</a>
        </div>
    </div>

    <!-- Assets Section -->
    <div class="row" id="balance-sheet-assets-section">
        
        <div class="col-md-6">
            <div style="background-color:#243865; padding: 4px;">
                <h3 style="color: aliceblue;" >Assets</h3>
            </div>
            <hr>
            <!-- Current Assets Table -->
            <h5 style="color: black;">Current Assets ($)</h5>
            <table class="table table-hover">
                <tbody>
                    {% for asset in assets %}
                        <tr>
                            <td>{{ asset.name }}</td>
                            <td>{{ asset.amount }}</td>
                            <td>
                                <div style="display: flex; align-items: center; justify-content: space-between; margin-top: 5px;">
                                    {% if request.user.is_superuser or request.user.is_admin %}
                                        <a href="{% url 'finance:update_statements' pk=asset.id %}" class="edit-btn">&#10004;</a>
                                    {% endif %}
                                </div>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr>
                        <th>Total Current Assets ($)</th>
                        <th>{{ total_current_assets }}</th>
                    </tr>
                </tfoot>
            </table>
        </div>
        <!-- Long-term Assets Table -->
        <div class="col-md-6">
            <div style="background-color:#243865; padding: 4px;">
                <h3 style="color: aliceblue;">Liabilities</h3>
            </div>
            <hr>
            <!-- Current Liabilities Table -->
            <h5 style="color: black;">Current Liabilities ($)</h5>
            <table class="table table-hover">
                <tbody>
                    {% for liabilitie in liabilities %}
                        <tr>
                            <td>{{ liabilitie.name }}</td>
                            <td>{{ liabilitie.amount }}</td>
                            <td>
                                <div style="display: flex; align-items: center; justify-content: space-between; margin-top: 5px;">
                                    {% if request.user.is_superuser or request.user.is_admin %}
                                        <a href="{% url 'finance:update_statements' pk=liabilitie.id %}" class="edit-btn">&#10004;</a>
                                    {% endif %}
                                </div>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr>
                        <th>Total Current Liabilities ($)</th>
                        <th>{{ total_current_liabilities }}</th>
                    </tr>
                </tfoot>
            </table>
        </div>
       
    </div>

    <!-- Liabilities Section -->
    <div class="row" id="balance-sheet-liabilities-section">
        <div class="col-md-6">
            <div style="background-color: #243865; padding: 4px;">
                <h4 style="color: aliceblue;">Long-term Assets</h4>
            </div>
            <hr>
            <h5 style="color: black;">Long-term Assets ($)</h5>
            <table class="table table-hover">
                <tbody>
                    {% for asset in long_term_assets %}
                        <tr>
                            <td>{{ asset.name }}</td>
                            <td>{{ asset.amount }}</td>
                            <td>
                                <div style="display: flex; align-items: center; justify-content: space-between; margin-top: 5px;">
                                    {% if request.user.is_superuser or request.user.is_admin %}
                                        <a href="{% url 'finance:update_statements' pk=asset.id %}" class="edit-btn">&#10004;</a>
                                    {% endif %}
                                </div>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr>
                        <th>Total Long-term Assets ($)</th>
                        <th>{{ total_long_term_assets }}</th>
                    </tr>
                </tfoot>
            </table>
        </div>
 
        <!-- Long-term Liabilities Table -->
        <div class="col-md-6">
            <div style="background-color:#243865; padding: 4px;">
                <h4 style="color: aliceblue;">Long-term Liabilities</h4>
            </div>
            <hr>
            <h5 style="color: black;">Current Long-term Liabilities ($)</h5>
            <table class="table table-hover">
                <tbody>
                    {% for liabilitie in long_term_liabilities %}
                        <tr>
                            <td>{{ liabilitie.name }}</td>
                            <td>{{ liabilitie.amount }}</td>
                            <td>
                                <div style="display: flex; align-items: center; justify-content: space-between; margin-top: 5px;">
                                    {% if request.user.is_superuser or request.user.is_admin %}
                                        <a href="{% url 'finance:update_statements' pk=liabilitie.id %}" class="edit-btn">&#10004;</a>
                                    {% endif %}
                                </div>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                    <tr>
                        <th>Total Long-term Liabilities ($)</th>
                        <th>{{ total_long_term_liabilities }}</th>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>

    <!-- Total Assets, Liabilities and Equity -->
    <div class="row" id="total-section">
        <div class="col-12">
            <table class="table table-hover">
                <tfoot>
                    <tr>
                        <div style="background-color:#243865; padding: 4px;"></div>
                        <th>Total Assets ($)</th>
                        <th>{{ total_assets }}</th>
                        <div style="background-color:#243865; padding: 4px;"></div>
                        <th>Total Liabilities and Equity ($)</th>
                        <th>{{ total_liabilities }}</th>
                        <div style="background-color:#243865; padding: 4px;"></div>
                    </tr>
                </tfoot>
            </table>
        </div>
    </div>

    <!-- Income Statement Section -->
<!-- Income Statement Section -->
    <div class="row mt-5" id="financial-statement-section"  style="display: none;">
        <!-- ... -->

        <!-- Revenue Section -->
        <div style="background-color:#243865; padding: 4px;">
            <h3 style="color: aliceblue;" >Revenues</h3>
        </div>
        <table class="table table-hover">
            <tbody>
                
                {% for asset in existing_revenue_data %}
                <tr>
                    <td>{{ asset.name }}</td>
                    <td>{{ asset.amount }}</td>
                    <td>
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-top: 5px;">
                            {% if request.user.is_superuser or request.user.is_admin %}
                                <a href="{% url 'finance:update_statements' pk=asset.id %}" class="edit-btn">&#10004;</a>
                            {% endif %}
                        </div>
                    </td>
                </tr>
                {% endfor %}
                <tr>
                    <th>Total Revenue</th>
                    <th>${{ total_revenue }}</th>
                </tr>
            </tbody>
        </table>

            <!-- Expenses Section -->
            <div style="background-color:#243865; padding: 4px;">
                <h3 style="color: aliceblue;" >Expenses</h3>
            </div>
            <table class="table table-hover">
                <tbody>
                    {% for expense in existing_expenses_data %}
                    <tr>
                        <td>{{ expense.name }}</td>
                        <td>{{ expense.amount }}</td>
                        <td>
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-top: 5px;">
                                {% if request.user.is_superuser or request.user.is_admin %}
                                    <a href="{% url 'finance:update_statements' pk=expense.id %}" class="edit-btn">&#10004;</a>
                                {% endif %}
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                    
                    <tr>
                        <th>Total Expenses</th>
                        <th>${{ total_expenses }}</th>
                    </tr>
                </tbody>
            </table>
            <table class="table">
                <tfoot>
                    <tr>
                        <th>Net Income</th>
                        <th>${{ net_income }}</th>
                    </tr>
                </tfoot>
            </table>
    </div>
</div>

<script>
    $(document).ready(function () {
        // Enable Bootstrap tooltips
        $('[data-toggle="tooltip"]').tooltip();
        
        // JavaScript code to display current date and time
        function updateCurrentDateTime() {
            var currentDateTimeElement = document.getElementById("current-date-time");
            var now = new Date();
            var year = now.getFullYear();
            var month = now.getMonth() + 1;
            var day = now.getDate();
            var hours = now.getHours();
            var minutes = now.getMinutes();
            var seconds = now.getSeconds();

            // Format the date as YYYY-MM-DD
            var formattedDate = year + "-" + (month < 10 ? "0" : "") + month + "-" + (day < 10 ? "0" : "") + day;

            // Format the time as HH:MM:SS
            var formattedTime = hours + ":" + (minutes < 10 ? "0" : "") + minutes + ":" + (seconds < 10 ? "0" : "") + seconds;

            // Combine date and time
            var dateTimeString = formattedDate + " " + formattedTime;

            // Update the content of the element
            currentDateTimeElement.innerText = dateTimeString;

            // Update the date and time every second
            setTimeout(updateCurrentDateTime, 1000);
        }

        // Call the function to start updating the date and time
        updateCurrentDateTime();
    });

    function showBalanceSheet() {
        document.getElementById('reportTitle').innerText = "{{ company_name }} Balance Sheet";
        document.getElementById('balance-sheet-assets-section').style.display = 'flex';
        document.getElementById('balance-sheet-liabilities-section').style.display = 'flex';
        document.getElementById('total-section').style.display = 'flex';
        document.getElementById('financial-statement-section').style.display = 'none';
    }

    function showFinancialStatement() {
        document.getElementById('reportTitle').innerText = "{{ company_name }} Financial Statement";
        document.getElementById('balance-sheet-assets-section').style.display = 'none';
        document.getElementById('balance-sheet-liabilities-section').style.display = 'none';
        document.getElementById('total-section').style.display = 'none';
        document.getElementById('financial-statement-section').style.display = 'flex';
    }

    function showCashFlowStatement() {
        document.getElementById('reportTitle').innerText = "{{ company_name }} Cash Flow Statement";
        document.getElementById('balance-sheet-assets-section').style.display = 'none';
        document.getElementById('balance-sheet-liabilities-section').style.display = 'none';
        document.getElementById('total-section').style.display = 'none';
        document.getElementById('financial-statement-section').style.display = 'none';
    }
</script>

{% endblock content %}