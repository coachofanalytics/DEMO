{% extends "main/base_templates/base.html" %}
{% block title %}Register{% endblock %}
{% load crispy_forms_tags %}
{% block content %}

<!-- Bootstrap CSS -->
<link rel="stylesheet"
    href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
    crossorigin="anonymous">

<!-- Bootstrap JS (Placed at the end of the body for better performance) -->
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzymwG+UuJ4L4W+enJGJ5jM5p4Qv9C/tvVffDkqkt8U2Fm2"
    crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>

<style>
    /* Container Styling */
    .sign-up-div {
        padding: 20px;
    }

    /* Introduction Section */
    .introduction-div {
        background-color: white;
        padding: 20px;
        border-radius: 8px;
    }

    /* Form Section */
    .form-div {
        margin-top: 15px;
    }

    /* Sign Up Button */
    #signupBtn {
        background-color: #03b1af;
        color: white;
        border: none;
        width: 100%;
        padding: 10px;
        border-radius: 4px;
        font-size: 16px;
        cursor: pointer;
        transition: background-color 0.3s ease;
    }

    #signupBtn:hover {
        background-color: #028a89;
    }

    /* Already Have an Account Link */
    .already-account {
        margin-top: -50px;
        text-align: center;
    }

    .already-account a {
        color: #03b1af;
        text-decoration: none;
        font-weight: bold;
    }

    .already-account a:hover {
        text-decoration: underline;
    }

    /* Separator */
    .separator {
        text-align: center;
        margin: 10px 0;
        position: relative;
    }

    .separator::before,
    .separator::after {
        content: "";
        position: absolute;
        top: 50%;
        width: 40%;
        height: 1px;
        background-color: #ccc;
    }

    .separator::before {
        left: 0;
    }

    .separator::after {
        right: 0;
    }

    .separator span {
        background-color: #fff;
        padding: 0 10px;
        position: relative;
        z-index: 1;
        color: #666;
    }

    /* Google Sign-In Button */
    .loginBtn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 100%;
        padding: 10px;
        font-family: 'Open Sans', sans-serif;
        font-size: 16px;
        font-weight: 600;
        text-align: center;
        text-decoration: none;
        color: #ffffff;
        background-color: #4285F4;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s ease, box-shadow 0.3s ease;
    }

    .loginBtn:hover {
        background-color: #357AE8;
        box-shadow: 0px 3px 5px rgba(0, 0, 0, 0.2);
    }

    .loginBtn:active {
        background-color: #2A65C1;
        box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.2);
    }

    /* Responsive Adjustments */
    @media (max-width: 768px) {
        .form-div {
            margin-top: 20px;
        }

        .loginBtn {
            margin-top: 10px;
        }
    }
</style>

<div class="sign-up-div">
    <form method="POST" id="signupForm" enctype="multipart/form-data" autocomplete="off">
        {% csrf_token %}
        <fieldset class="form-group">
            <div class="row">
                <!-- Introduction Section -->
                <div class="col-lg-6 introduction-div" style="background-color: white;">
                    <h1 class="text" style="color: #048080;">SIGN-UP</h1>
                    <div class="content" style="color: black;">
                        <p class="mb-2" style="color: black;">Welcome to DC48K, Are you NEW here?</p>
                        <p style="color: black;">
                            Sign-up to enjoy all the benefits DC48K
                            provides.
                        </p>
                    </div>
                    <h2 class="text" style="color: black;">Pick your Category | Register As:</h2>
                    <div class="form-group">
                        <select name="category" class="form-control" id="id_category" required>
                            <option value="" disabled selected>Select Category</option>
                            <option value="1">Ordinary Member (Free)</option>
                            <option value="2">Active Member</option>
                            <option value="3">Executive Member</option>
                            <option value="4">FBO & Ordinary (Free)</option>
                            <option value="5">Active Organization</option>
                            <option value="6">Royal Organization</option>
                        </select>
                    </div>
                </div>

                <!-- Form Fields Section -->
                <div class="col-lg-6 form-div">
                    <!-- First Name -->
                    <div class="form-group row">
                        <div class="col-md-12">
                            <label for="id_first_name">First Name*</label>
                            {{ form.first_name|as_crispy_field }}
                        </div>
                    </div>

                    <!-- Last Name -->
                    <div class="form-group row">
                        <div class="col-md-12">
                            <label for="id_last_name">Last Name*</label>
                            {{ form.last_name|as_crispy_field }}
                        </div>
                    </div>

                    <!-- Email -->
                    <div class="form-group row">
                        <div class="col-md-12">
                            <label for="id_email">Email*</label>
                            {{ form.email|as_crispy_field }}
                        </div>
                    </div>

                    <!-- Sign Up Button -->
                    <div class="form-group">
                        <button type="submit" id="signupBtn">Sign Up</button>
                    </div>

                    <!-- Already Have an Account Link -->
                    <div class="already-account">
                        <small class="text-muted">
                            Already have an account?
                            <a href="{% url 'accounts:account-login' %}">Sign In</a>
                        </small>
                    </div>

                    <!-- Separator -->
                    <div class="separator">
                        <span>or</span>
                    </div>

                    <!-- Sign Up with Google Button -->
                    <div class="form-group">
                        <a id="google-signin-link" href="{% url 'custom_social_login' %}" onclick="return enableSocialSignInLink(event, this, 'google_login')" class="loginBtn">
                            Sign up with Google
                        </a>
                    </div>
                </div>
            </div>
        </fieldset>
    </form>
</div>

<!-- JavaScript for Social Sign-In -->
<script>
    function enableSocialSignInLink(event, doc, value) {
        // Get the selected category value
        var selectedCategory = document.getElementById("id_category"); 
        console.log('Selected Category:', selectedCategory.value);     

        if (selectedCategory.value === "") {
            alert("Please select a category");
            return false;
        }

        // Append category and social platform as query parameters
        var currentHref = doc.getAttribute('href');

        // Check if href already has query parameters
        var separator = currentHref.includes('?') ? '&' : '?';
        var newHref = currentHref + separator + 'category=' + selectedCategory.value + '&socialPlatform=' + value;

        // Update the href attribute with the new value
        doc.setAttribute('href', newHref);        

        return true;
    }
</script>

{% endblock content %}
